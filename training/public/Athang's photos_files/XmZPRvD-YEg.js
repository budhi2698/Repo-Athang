;/*FB_PKG_DELIM*/

__d("XFeedSubFollowController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/feed/profile/sub_follow/",{__asyncDialog:{type:"Int"},id:{type:"Int"},action:{type:"Enum",enumType:1},location:{type:"Int"}})}),null);
__d("MProfileSeeFirst",["$","Bootloader","CSS","DOM","FollowStrings","MRequest","MURI","Stratcom","SubscriptionsHandler","XFeedSubFollowController","destroyOnUnload"],(function(a,b,c,d,e,f,g){var h,i,j,k="unfollow",l="follow",m="see_first",n="/a/subscriptions/remove",o="/a/subscriptions/add",p=151,q=function(){function a(a,b,e,f,g,q,r,s,t,u,v,w,x){var y=this;this.changeFollowState=function(a){if(a===y.$6)return;a===k&&y.$1.removeAttribute("data-sigil");y.changeFollowStateUI(a);if(y.$6===k){var b=y.$13===p&&y.$16!==null&&y.$16!==void 0?new(c("MRequest"))(y.$16):new(c("MRequest"))(new(c("MURI"))(o));b.setData({subject_id:y.$7,forceredirect:!1,location:y.$13});b.listen("done",function(){a===m?y.changeSubFollowState(a):y.$6=a});b.listen("error",y.changeFollowStateUI.bind(y,y.$6));b.send()}else if(a===k){b=new(c("MRequest"))(new(c("MURI"))(n)).setData({subject_id:y.$7,forceredirect:!1,location:y.$13});b.listen("error",y.changeFollowStateUI.bind(y,y.$6));b.listen("done",function(){y.$6=a});b.send()}else y.changeSubFollowState(a);y.$10&&(a===k||a===m?y.renderAwesomizerUpsell(a,y.$12):a===l&&(i&&i.hideAwesomizerUpsell()))};this.changeFollowStateUI=function(a){var b=y.getActiveFollowButton(a);c("CSS").removeClass(y.$2,"selectedOption");c("CSS").removeClass(y.$3,"selectedOption");y.$4&&c("CSS").removeClass(y.$4,"selectedOption");b&&c("CSS").addClass(b,"selectedOption");y.setActionBarFollowButton(a);d("DOM").setContent(y.$5,y.getFollowString(a))};this.destroy=function(){j&&(h.unmountComponentAtNode(j),d("DOM").remove(j),j=null,i=null),y.$14&&y.$14.release(),y.$14=null,y.$15&&y.$15.remove()};this.$1=a;this.$2=b;this.$3=e;this.$4=f;this.$5=g.children[0];this.$6=q;this.$7=r;this.$8=s;this.$9=t;this.$10=u;this.$11=!1;this.$12=v;this.$13=w;this.$16=x;g=this.getActiveFollowButton(this.$6);g&&c("CSS").addClass(g,"selectedOption");d("DOM").setContent(this.$5,this.getFollowString(this.$6));this.$14=new(c("SubscriptionsHandler"))();this.$14.addSubscriptions(d("DOM").listen(a,"click",null,function(){y.$6===k&&!y.$11&&(y.$1.setAttribute("data-sigil","follow-flyout"),y.changeFollowState(l)),y.$11=!y.$11,y.$11||i&&i.hideAwesomizerUpsell()}),d("DOM").listen(b,"click",null,this.changeFollowState.bind(this,k)),d("DOM").listen(e,"click",null,this.changeFollowState.bind(this,l)));this.$14&&f&&this.$14.addSubscriptions(d("DOM").listen(f,"click",null,this.changeFollowState.bind(this,m)));c("destroyOnUnload")(this.destroy.bind(this))}var e=a.prototype;e.setActionBarFollowButton=function(a){if(a===this.$6)return;c("CSS").removeClass(this.$1,"following");c("CSS").removeClass(this.$1,"seefirst");c("CSS").removeClass(this.$1,"follow");a===k?c("CSS").addClass(this.$1,"follow"):a===l?c("CSS").addClass(this.$1,"following"):c("CSS").addClass(this.$1,"seefirst");if(this.$13!==364&&this.$13!==365){var b=d("DOM").find(this.$1,"*","m-profile-action-button-label");d("DOM").setContent(b,this.getActionBarButtonText(a))}else if(this.$13==364){b=d("DOM").find(this.$1,"*","m-profile-action-rectangular-button-label");d("DOM").setContent(b,this.getActionBarButtonText(a))}};e.renderAwesomizerUpsell=function(a,e){c("Bootloader").loadModules(["React","ReactDOM","MAwesomizerUpsell.react"],function(f,g,k){b=f;h=g;j||(j=d("DOM").create("div"),c("$")("page").appendChild(j));f={followState:a,isWorkUser:e};i=h.render(b.jsx(k,babelHelpers["extends"]({},f)),j,"MProfileSeeFirst.js")},"MProfileSeeFirst")};e.changeSubFollowState=function(a){var b=this;a===m&&(this.$15=c("Stratcom").listen("revert",null,function(){c("Stratcom").removeCurrentListener(),alert(b.$9),b.changeFollowStateUI(l),b.$6=l}));var d=c("XFeedSubFollowController").getURIBuilder().setInt("id",this.$7).setEnum("action",a).setInt("location",this.$13).getURI();d=new(c("MRequest"))(d);d.listen("done",function(){b.$6=a});d.listen("error",this.changeFollowStateUI.bind(this,this.$6));d.send()};e.getActionBarButtonText=function(a){if(a===k)return c("FollowStrings").follow;else if(a===l)return c("FollowStrings").followed;else return c("FollowStrings").seeFirst};e.getFollowString=function(a){if(a===k)if(this.$8)return c("FollowStrings").unfollowFriendSubtextMobile;else return c("FollowStrings").unfollowNonFriendSubtextMobile;else if(a===l)return c("FollowStrings").regularFollowSubtextMobile;else return c("FollowStrings").seeFirstSubtextMobile};e.getActiveFollowButton=function(a){if(a===k)return this.$2;else if(a===l)return this.$3;else return this.$4};return a}(),r=null;function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){r&&r.destroy(),r=new q(a,b,c,d,e,f,g,h,i,j,k,l,m)}g.init=a}),98);